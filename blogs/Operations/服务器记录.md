## 腾讯云服务器Docker服务端口失效

服务器上Docker运行的服务无法访问，先测试域名访问失效，公网ip端口访问失效；

检查：服务已启动，服务器ssh连接正常，服务器本地127.0.0.1端口访问正常，腾讯云控制台防火墙已开放端口，服务器系统防火墙已关闭；

原因：未开启IP转发功能

在一些情况下，Docker运行的服务映射端口需要启用IP转发功能，以便Docker能将网络请求转发到docker0网桥，并最终传递给容器。

```bash
# 检查是否启用
[root@VM-8-12-centos ~]# sudo sysctl -p
kernel.core_uses_pid = 1
net.ipv4.ip_forward = 1 # 1为启用，0为关闭
net.ipv6.conf.all.forwarding = 0
net.ipv4.conf.default.rp_filter = 1
kernel.msgmnb = 65536
kernel.msgmax = 65536
net.ipv4.conf.default.accept_source_route = 0
net.ipv4.tcp_syncookies = 1
net.ipv6.conf.all.disable_ipv6 = 0
net.ipv6.conf.default.disable_ipv6 = 0
net.ipv6.conf.lo.disable_ipv6 = 0
net.ipv4.conf.all.promote_secondaries = 1
net.ipv4.conf.default.promote_secondaries = 1
net.ipv6.neigh.default.gc_thresh3 = 4096
net.ipv4.neigh.default.gc_thresh3 = 4096
kernel.printk = 5 4 1 7
kernel.softlockup_panic = 1
net.ipv4.tcp_max_tw_buckets = 4096
net.core.somaxconn = 4096
net.ipv4.tcp_slow_start_after_idle = 0
kernel.sysrq = 1
kernel.shmmax = 68719476736
# 检查方式二
[root@VM-8-12-centos ~]# cat /proc/sys/net/ipv4/ip_forward
1

# 修改命令 echo 1 > /proc/sys/net/ipv4/ip_forward
[root@VM-8-12-centos ~]# echo 1 > /proc/sys/net/ipv4/ip_forward
```

